{{page-title (concat @model.user.login ' - Profile')}}

<Admin::User::Page @user={{@model.user}}>
  <div local-class='profile'>
    <h2>Profile</h2>

    <User::Info @user={{@model.user}}>
      <dt>ID</dt>
      <dd>{{@model.user.id}}</dd>
      <dt>E-mail</dt>
      <dd>
        {{#if @model.user.email}}
          <a href='mailto:{{@model.user.email}}'>{{@model.user.email}}</a>
          {{#if @model.user.email_verified}}
            <span local-class='verified'>Verified!</span>
          {{else if @model.user.email_verification_sent}}
            <span local-class='pending'>Verification pending</span>
          {{else}}
            <span local-class='unverified'>Unverified</span>
          {{/if}}
        {{else}}
          No e-mail on record
        {{/if}}
      </dd>
      <dt>crates.io admin</dt>
      <dd>
        {{#if @model.user.is_admin}}Yes{{else}}No{{/if}}
      </dd>
    </User::Info>
  </div>

  <div local-class='locked'>
    <h2>Lock status</h2>

    <div local-class='lock-status'>
      {{#if this.isCurrentlyLocked}}
        <p>This user's account is locked!</p>
        <Admin::User::Lock @reason={{this.lockReason}} @until={{this.lockedUntil}} />
      {{else if this.wasPreviouslyLocked}}
        <p>This user's account is currently unlocked, but was previously locked.</p>
        <Admin::User::Lock @reason={{this.lockReason}} @until={{this.lockedUntil}} />
      {{else}}
        This user's account has never been locked.
      {{/if}}
    </div>

    <div>
      {{#if this.isCurrentlyLocked}}
        <PrivilegedAction>
          <button
            type='button'
            local-class='unlock-button'
            disabled={{this.unlockTask.isRunning}}
            {{on 'click' (prevent-default (perform this.unlockTask))}}
          >Unlock account</button>
        </PrivilegedAction>
      {{else}}
        <h3>Lock account</h3>
        <PrivilegedAction>
          <form {{on 'submit' (prevent-default (perform this.lockTask))}}>
            <fieldset local-class='lock-form' disabled={{this.lockTask.isRunning}}>
              {{#let (unique-id) as |id|}}
                <label for={{id}}>Reason</label>
                <Input @type='text' @value={{this.reason}} id={{id}} required />
              {{/let}}

              {{#let (unique-id) as |id|}}
                <label for={{id}}>For</label>
                <select id={{id}} required {{on 'change' this.updateDays}}>
                  <option value='none' selected={{not this.days}}>No expiration</option>
                  <option value='1' selected={{eq this.days '1'}}>1 day</option>
                  <option value='7' selected={{eq this.days '7'}}>7 days</option>
                  <option value='30' selected={{eq this.days '30'}}>30 days</option>
                  <option value='90' selected={{eq this.days '90'}}>90 days</option>
                  <option value='365' selected={{eq this.days '365'}}>365 days</option>
                </select>
              {{/let}}

              <button type='submit' local-class='lock-button'>Lock account</button>
            </fieldset>
          </form>
        </PrivilegedAction>
      {{/if}}
    </div>
  </div>
</Admin::User::Page>